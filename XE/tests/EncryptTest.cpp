#include <gtest/gtest.h>

#include <XE.h>

TEST( EncryptTest, TestEncrypt )
{
	XE::String text = "1234567890abcdef!@#$%^&*()";

	XE::MD5 md5;
	XE::SHA1 sha1;
	XE::CRC32 crc32;
	XE::SHA2_224 sha2_224;
	XE::SHA2_256 sha2_256;
	XE::SHA2_384 sha2_384;
	XE::SHA2_512 sha2_512;
	XE::SHA3_224 sha3_224;
	XE::SHA3_256 sha3_256;
	XE::SHA3_384 sha3_384;
	XE::SHA3_512 sha3_512;

	md5.Add( text ).Finalize();
	sha1.Add( text ).Finalize();
	crc32.Add( text ).Finalize();
	sha2_224.Add( text ).Finalize();
	sha2_256.Add( text ).Finalize();
	sha2_384.Add( text ).Finalize();
	sha2_512.Add( text ).Finalize();
	sha3_224.Add( text ).Finalize();
	sha3_256.Add( text ).Finalize();
	sha3_384.Add( text ).Finalize();
	sha3_512.Add( text ).Finalize();

	EXPECT_TRUE( crc32.ToUint32() == 0x1C63BEAC );
	EXPECT_TRUE( md5.ToString() == "2E241122542B069F0D8C8B0F3CA4CAC6" );
	EXPECT_TRUE( sha1.ToString() == "12E871D2A10ADA141967DF4A8DF68414305E8DCB" );
	EXPECT_TRUE( sha2_224.ToString() == "E8E7BDF6E3322FD4932C1041B3293245886F153D00852ED23EBDD3DF" );
	EXPECT_TRUE( sha2_256.ToString() == "4CB0D947A633BB5223835681EAFE416AD03F79F9CFD04EAE3306E9951C6FA771" );
	EXPECT_TRUE( sha2_384.ToString() == "8C00C5BC303F6FCA117825E6BB4BD786735BC87A17F445DFBFA12B510B360426417E81A2C71D52B1520477861C8279EB" );
	EXPECT_TRUE( sha2_512.ToString() == "4090764E3F8CE8D57CB8DE62BF0663C1C8E7177C6B160890F2CC3C5EBDF96DE57D6EA1DA109C0A954346B31905B221A1E241B3D2E9F04B6A2DE28C8523738DB1" );
	EXPECT_TRUE( sha3_224.ToString() == "A28120296CABFCBE4648858F8C505AEB2A02C0BF084A384B33EC3C30" );
	EXPECT_TRUE( sha3_256.ToString() == "A17CFB88527F2D4F066769F9B063D0CFCA66E3BF45005FEC8B75694F4825DE49" );
	EXPECT_TRUE( sha3_384.ToString() == "6F634F55ED42D050E1CC01E751EC5812DE70CE6490F4D7E5E5A85348589D2E0C489064EAE5046EAF03A2D4CBCA3C97F9" );
	EXPECT_TRUE( sha3_512.ToString() == "5C2C214FB1F79D5BD5644595BEFEEABA3239405A1C498D609C4F07C58E616D9EBF3AD720B4F6BA99AA915C4F0765A46AA8DC8764FE996F95DF7FD0D567111DB0" );
}
